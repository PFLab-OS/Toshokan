paging/012: 4KBのメモリ
==========================

今回使用するディレクトリ：[sample/paging/011](https://github.com/PFLab-OS/Toshokan/tree/master/sample/paging/011)

Attention: 011のコードを引き続き使用します。

[paging/011](011.md)のコードは、0xC0000000からの仮想メモリと、0x80001000からの物理メモリを同一にする、というコードらしい、という事が何となく分かったかと思います。

では、0xC0000000からの仮想メモリは、どこまでが0x80001000からの物理メモリなのでしょう？気になりませんか？調べてみましょう。

プログラムをmakeして、QEMUコンソールを開いてください。

```
(qemu) cpu 1
(qemu) x /10x 0xC0000000
00000000c0000000: 0x80002027 0x00000000 0x00000000 0x00000000
00000000c0000010: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000020: 0x00000000 0x00000000
```

これは同じ結果ですよね。では次はどうでしょうか？

```
(qemu) x /20x 0xC0000000
00000000c0000000: 0x80002027 0x00000000 0x00000000 0x00000000
00000000c0000010: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000020: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000030: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000040: 0x00000000 0x00000000 0x00000000 0x00000000
```

表示されるメモリが2倍に増えました。`x /20x`の`20`をどんどん増やしていけば、より多くのメモリ領域が表示されるはずです。

では、`20`ではなくて、`1100`としてみてください。

```
(qemu) x /1100x 0xC0000000
00000000c0000000: 0x80002027 0x00000000 0x00000000 0x00000000
00000000c0000010: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000020: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000030: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000040: 0x00000000 0x00000000 0x00000000 0x00000000
＜中略＞
00000000c0000fc0: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000fd0: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000fe0: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0000ff0: 0x00000000 0x00000000 0x00000000 0x00000000
00000000c0001000: Cannot access memory
```

`0xC0001000`の所で`Cannot access memory`と出ました。このメッセージ、[paging/003.md](003.md)と同じですね。

ここから分かるのは0xC0000000〜0xC0001000の仮想メモリが0x80001000〜の物理メモリに対応してそうだ、という事です。素直に考えれば、0xC0000000〜0xC0001000の仮想メモリは0x80001000〜0x80002000の物理メモリに対応しているのでしょう。

0xC0000000〜0xC0001000のメモリ領域の大きさを考えてみましょう。簡単な引き算で、これは`0x1000byte`です。10進数に直せば、4KBとなります。この4KBが何を意味するのか、もう少し掘り下げて考えていきましょう。

[このセクションの目次に戻る](index.md)
